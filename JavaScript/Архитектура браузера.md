Связана с темой [[Event Loop]]

![[Pasted image 20250707123337.png]]

### 1. **User Interface (UI)**

- То, что ты видишь: адресная строка, кнопки назад/вперед, вкладки и т.д.
- UI сам по себе не участвует в обработке JS или рендеринге страницы.


### 2. **Browser Engine**

- Связывает UI и Rendering Engine.
- Управляет потоками, навигацией, безопасностью, координацией компонентов.
- Пример: в **Chrome** — это **Chromium's browser engine**, в **Firefox** — **Gecko**.


### 3. **Rendering Engine**

- Отвечает за отображение содержимого: HTML, CSS.
- Примеры:
    - Chrome: **Blink**
    - Firefox: **Gecko**
- Разбивает HTML в DOM, CSS в CSSOM, объединяет их в Render Tree и рендерит.


### 4. **JS interpreter**

- Отвечает за **выполнение JavaScript-кода**.  Решает задачи:
	- Предоставляет `heap` (так называемую кучу) - область памяти, используемая для динамического выделения памяти под объекты и функции во время выполнения программы
	- Отвечает за обработку стека вызовов (`Call Stack`).
	- Работа с памятью (выделение памяти, сборка мусора).
	- Компиляция JS в машинный код.
	- Внутренние точечные оптимизации
	
- Примеры:
    - Chrome: **V8**
    - Firefox: **SpiderMonkey**

| Компонент             | Chrome                        | Firefox      |
| --------------------- | ----------------------------- | ------------ |
| **Browser Engine**    | **Chromium’s Browser Engine** | Gecko        |
| **Rendering Engine**  | **Blink**                     | Gecko        |
| **JavaScript Engine** | **V8**                        | SpiderMonkey |

## Другие  блоки:

- **Networking**: предназначена для работы с сетью. Отвечает за историю загрузку данных,  взаимодействие с DNS-сервером, открытие соединений, обмен пакетами и т.д.  В общем за все, что связано с сетью. 
- **Data Persistence**: хранит куки, localStorage, кэш и т.д. 
- **UI Backend**: отрисовывает элементы интерфейса через OS (например, кнопки, скроллы).


>[!warning] 
>`Event Loop` не является частью JS, это часть среды исполнения, например, браузера или Node js. `Event Loop` обрабатывает очередь задач (callbacks, events, async/await).

Взаимодействие `Event Loop`, который предоставляется браузером, и `Call Stack`, который  предоставляется движком, осуществляется через `WebApi`, который также предоставляется браузером.

 `WebApi` позволяет движку JS обращаться к:
 
- DOM (`document.querySelector`)
- таймерам (`setTimeout`)
- сетевым запросам (`fetch`)
- событиям (`addEventListener`)
- и другим браузерным возможностям.

⚠️ Эти API не входят в сам язык JavaScript — они реализованы **в движке браузера**, а не в JS-интерпретаторе.

Например, когда JS код вызывает `setTimeout`, этот вызов уходит в `Web API`. После истечения времени, `Web API` ставит callback в очередь. `Event Loop` проверяет, свободен ли `Call Stack`, и если да — передает callback в выполнение


> [!success] 
> Вся архитектура браузера построена так, чтобы UI был отзывчивым. JS-интерпретатор выполняет код, Web API обрабатывает асинхронные задачи, Event Loop координирует выполнение, а Rendering Engine отвечает за отрисовку. Эти части работают вместе, чтобы пользователь видел динамичный интерфейс и мог с ним взаимодействовать.

